---
image: coderus/sailfishos-platform-sdk:latest
variables:
  GIT_SUBMODULE_STRATEGY: recursive
  SFOS_VERSION: latest

cache:
  paths:
    - /var/cache/zypp/

build-arm:
  stage: build
  variables:
    TARGET: "armv7hl"
  script:
    - .ci/build.sh
  cache:
    paths:
      - /srv/mer/targets/SailfishOS-$SFOS_VERSION-$TARGET/var/cache/zypp/
  artifacts:
    paths:
      - RPMS/*.rpm

build-x86:
  stage: build
  variables:
    TARGET: "i486"
  script:
    - .ci/build.sh
  cache:
    paths:
      - /srv/mer/targets/SailfishOS-$SFOS_VERSION-$TARGET/var/cache/zypp/
  artifacts:
    paths:
      - RPMS/*.rpm
